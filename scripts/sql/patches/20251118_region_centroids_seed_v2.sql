-- 20251118_region_centroids_seed_v2.sql
-- FoxProFlow / GEO core
-- Idempotent seed ключевых центроидов регионов/городов для маршрутизации.
--
-- Назначение:
--   * дать координаты для частых origin_region/dest_region в public.trip_segments
--     (RU-MOW → RU-KGD / RU-NVS, Белгород ↔ Воронеж, Казань, Брянск, Архангельск и т.п.);
--   * обеспечить стабильный backfill src_lat/src_lon и dst_lat/dst_lon
--     из таблицы public.region_centroids (см. отдельный патч backfill’а);
--   * минимизировать хвост «без дороги» по данным SMOKE-отчёта
--     (ff-routing-smoke.ps1) за счёт покрытия ключевых регионов/городов.
--
-- Скрипт безопасен для многократного запуска (ON CONFLICT … DO UPDATE).

INSERT INTO public.region_centroids (code, name, lat, lon) VALUES
  -- Базовые, которые уже были (на случай нового стенда):
  -- Москва, Санкт-Петербург, Нижегородская, Владимирская область и т.п.
  ('RU-ALT',     'Altai Krai (Barnaul)',    53.349800, 83.776900),
  ('RU-MOW',     'Москва',                  55.755826, 37.617299),
  ('RU-NIZ',     'Нижегородская обл.',      56.326797, 44.006516),
  ('RU-SPE',     'Санкт-Петербург',         59.939095, 30.315868),
  ('RU-VLA',     'Владимирская область',    56.129000, 40.406000),

  -- Ключевые сиды для тестового мира и реальных фрахтов:

  -- Белгородский кластер
  ('RU-BEL',     'БЕЛГОРОДСКАЯ ОБЛАСТЬ',    50.610700, 36.580200),
  ('RU-BEL-BEL', 'БЕЛГОРОД',                50.610700, 36.580200),

  -- Воронежский кластер
  ('RU-VOR',     'ВОРОНЕЖСКАЯ ОБЛАСТЬ',     51.672000, 39.184300),
  ('RU-VOR-VOR', 'ВОРОНЕЖ',                 51.672000, 39.184300),

  -- Казань (столица Татарстана)
  ('RU-TA-KAZ',  'КАЗАНЬ',                  55.788700, 49.122100),

  -- Ключевые магистральные регионы тестов: Калининград и Новосибирск
  ('RU-KGD',     'КАЛИНИНГРАДСКАЯ ОБЛАСТЬ', 54.706500, 20.511000),
  ('RU-NVS',     'НОВОСИБИРСКАЯ ОБЛАСТЬ',   55.041500, 82.934600),

  -- Московская область (частые пары БРЯНСК/БЕЛГОРОД/… → МОСКОВСКАЯ ОБЛАСТЬ)
  ('RU-MOS',     'МОСКОВСКАЯ ОБЛАСТЬ',      55.755826, 37.617299),

  -- Брянский кластер (виден в хвосте SMOKE как origin_region и как область)
  ('RU-BRY',     'БРЯНСКАЯ ОБЛАСТЬ',        53.252100, 34.371700),
  ('RU-BRY-BRY', 'БРЯНСК',                  53.252100, 34.371700),

  -- Архангельский кластер
  ('RU-ARK',     'АРХАНГЕЛЬСКАЯ ОБЛАСТЬ',   64.539911, 40.515762),
  ('RU-ARK-ARK', 'АРХАНГЕЛЬСК',             64.539911, 40.515762),

  -- Ярославль
  ('RU-YAR',     'ЯРОСЛАВЛЬ',               57.626569, 39.893787),

  -- Челябинск
  ('RU-CHE-CHL', 'ЧЕЛЯБИНСК',               55.160366, 61.400785),

  -- Псковская область
  ('RU-PSK',     'ПСКОВСКАЯ ОБЛАСТЬ',       57.819284, 28.331818),

  -- Краснодаский и ростовский кластеры (часто в dest_region)
  ('RU-KDA',     'КРАСНОДАРСКИЙ КРАЙ',      45.035470, 38.975313),
  ('RU-ROS',     'РОСТОВСКАЯ ОБЛАСТЬ',      47.222078, 39.720358),

  -- Астраханская область
  ('RU-AST',     'АСТРАХАНСКАЯ ОБЛАСТЬ',    46.349685, 48.040833),

  -- Калужская область
  ('RU-KLU',     'КАЛУЖСКАЯ ОБЛАСТЬ',       54.513845, 36.261215),

  -- Ленинградская область
  ('RU-LEN',     'ЛЕНИНГРАДСКАЯ ОБЛАСТЬ',   59.938951, 30.315635),

  -- Русский синоним Алтайского края (в данных часто "АЛТАЙСКИЙ КРАЙ")
  ('RU-ALT-RU',  'АЛТАЙСКИЙ КРАЙ',          53.349800, 83.776900),

  -- Город Новосибирск (dest_region = "НОВОСИБИРСК")
  ('RU-NSK',     'НОВОСИБИРСК',             55.041500, 82.934600),

  -- Республика Карелия (АСТРАХАНЬ → РЕСПУБЛИКА КАРЕЛИЯ и т.п.)
  ('RU-KR',      'РЕСПУБЛИКА КАРЕЛИЯ',      61.785017, 34.346878)
ON CONFLICT (code) DO UPDATE
SET
  name = EXCLUDED.name,
  lat  = EXCLUDED.lat,
  lon  = EXCLUDED.lon;
